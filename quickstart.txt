# ğŸš€ ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ

## ğŸ“‹ ìš”ì•½

ì´ í”„ë¡œì íŠ¸ëŠ” **Water-Net ì „ì²˜ë¦¬ + VAE + Diffusion Model**ì„ ê²°í•©í•œ ìˆ˜ì¤‘ ì´ë¯¸ì§€ í–¥ìƒ ëª¨ë¸ì…ë‹ˆë‹¤.

## âš¡ 1ë¶„ ì„¤ì •

### 1. ê¸°ë³¸ ì„¤ì •
```bash
# 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt

# 2. ì „ì²´ í™˜ê²½ ìë™ ì„¤ì • (í…ŒìŠ¤íŠ¸ ë°ì´í„° í¬í•¨)
python setup_dataset.py --dataset test --test_samples 50

# 3. ë°ëª¨ ì‹¤í–‰ìœ¼ë¡œ ëª¨ë“  ê²ƒì´ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸
python demo.py --demo all
```

**ë!** ğŸ‰ ì´ì œ ëª¨ë¸ì´ ì‘ë™í•©ë‹ˆë‹¤!

---

## ğŸ¯ ë°ì´í„°ë¥¼ ì–´ë””ì— ë„£ì–´ì•¼ í•˜ë‚˜ìš”?

### ğŸ“ ë°ì´í„° ìœ„ì¹˜
```
underwater-image-enhancement/
â”œâ”€â”€ DATA/                     # ğŸ‘ˆ ì—¬ê¸°ì— ëª¨ë“  ë°ì´í„°ì…‹!
â”‚   â”œâ”€â”€ UIEB/                # UIEB ë°ì´í„°ì…‹
â”‚   â”‚   â”œâ”€â”€ raw-890/         # ì €í•˜ëœ ì´ë¯¸ì§€ë“¤
â”‚   â”‚   â”œâ”€â”€ reference-890/   # ê°œì„ ëœ ì´ë¯¸ì§€ë“¤
â”‚   â”‚   â””â”€â”€ challengingset-60/ # í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ë“¤
â”‚   â””â”€â”€ LSUI/                # LSUI ë°ì´í„°ì…‹  
â”‚       â”œâ”€â”€ input/           # ì…ë ¥ ì´ë¯¸ì§€ë“¤
â”‚       â””â”€â”€ GT/              # Ground Truth ì´ë¯¸ì§€ë“¤
â”œâ”€â”€ models/
â”œâ”€â”€ train.py
â””â”€â”€ ...
```

### ğŸ¨ í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ìƒì„± (ì‹¤ì œ ë°ì´í„° ì—†ì„ ë•Œ)
```bash
# 50ê°œì˜ í•©ì„± ìˆ˜ì¤‘ ì´ë¯¸ì§€ ìƒì„±
python create_test_data.py --dataset_type UIEB --num_samples 50

# ë°ì´í„°ê°€ ì œëŒ€ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
python check_dataset.py --dataset_type UIEB --report
```

### ğŸ“¥ ì‹¤ì œ ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ
- **UIEB**: [ê³µì‹ í˜ì´ì§€](https://li-chongyi.github.io/proj_benchmark.html)
- **LSUI**: [GitHub](https://github.com/dalabdune/LSUI)

---

## ğŸƒâ€â™‚ï¸ ë°”ë¡œ ì‚¬ìš©í•˜ê¸°

### 1. ë°ëª¨ ì‹¤í–‰
```bash
# ì „ì²´ ê¸°ëŠ¥ ë°ëª¨
python demo.py --demo all

# ë‹¨ì¼ ì´ë¯¸ì§€ í–¥ìƒ (ì´ë¯¸ì§€ê°€ ìˆëŠ” ê²½ìš°)
python demo.py --demo image --image your_underwater_image.jpg --output enhanced.jpg
```

### 2. í›ˆë ¨ ì‹œì‘
```bash
# UIEB ë°ì´í„°ì…‹ìœ¼ë¡œ í›ˆë ¨
python train.py --config configs/uieb.yaml --exp_name my_experiment

# ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ (lightweight ëª¨ë¸)
python train.py --config configs/lightweight.yaml --exp_name quick_test
```

### 3. í…ŒìŠ¤íŠ¸
```bash
# ë‹¨ì¼ ì´ë¯¸ì§€ í…ŒìŠ¤íŠ¸
python test.py --mode single \
    --model_path experiments/my_experiment/checkpoints/best_model.pth \
    --input_image test.jpg \
    --output_image enhanced.jpg

# ì—¬ëŸ¬ ì´ë¯¸ì§€ ë°°ì¹˜ í…ŒìŠ¤íŠ¸
python test.py --mode batch \
    --model_path experiments/my_experiment/checkpoints/best_model.pth \
    --input_dir ./test_images/ \
    --output_dir ./enhanced_images/
```

### 4. Python ì½”ë“œì—ì„œ ì‚¬ìš©
```python
from models import UnderwaterEnhancementModel
from PIL import Image
import torchvision.transforms as transforms

# ëª¨ë¸ ë¡œë“œ
model = UnderwaterEnhancementModel('path/to/checkpoint.pth')

# ì´ë¯¸ì§€ ë¡œë“œ ë° ë³€í™˜
image = Image.open('underwater_image.jpg')
transform = transforms.Compose([
    transforms.Resize((256, 256)),
    transforms.ToTensor()
])
image_tensor = transform(image).unsqueeze(0)

# ì´ë¯¸ì§€ í–¥ìƒ
enhanced = model.enhance_image(image_tensor, num_steps=50)

# ê²°ê³¼ ì €ì¥
enhanced_pil = transforms.ToPILImage()(enhanced.squeeze(0))
enhanced_pil.save('enhanced_result.jpg')
```

---

## ğŸ› ï¸ ì„¤ì • ì˜µì…˜

### ëª¨ë¸ ì„¤ì •
```python
# config.pyì—ì„œ ë˜ëŠ” YAML íŒŒì¼ë¡œ
config = {
    'model': {
        'img_size': 256,        # ì´ë¯¸ì§€ í¬ê¸°
        'base_channels': 128,   # ëª¨ë¸ í¬ê¸° (64=ê°€ë²¼ì›€, 192=ê³ í’ˆì§ˆ)
        'time_steps': 1000,     # Diffusion ìŠ¤í… (500=ë¹ ë¦„, 2000=ê³ í’ˆì§ˆ)
    },
    'training': {
        'batch_size': 8,        # ë°°ì¹˜ í¬ê¸° (GPU ë©”ëª¨ë¦¬ì— ë”°ë¼ ì¡°ì •)
        'num_epochs': 1000,     # í›ˆë ¨ ì—í¬í¬
        'vae_lr': 1e-4,         # VAE í•™ìŠµë¥ 
        'diffusion_lr': 1e-4,   # Diffusion í•™ìŠµë¥ 
    }
}
```

### ì‚¬ì „ ì •ì˜ëœ ì„¤ì •
```bash
# ê°€ë²¼ìš´ ëª¨ë¸ (ë¹ ë¥¸ í›ˆë ¨/ì¶”ë¡ )
python train.py --config configs/lightweight.yaml

# ê³ í’ˆì§ˆ ëª¨ë¸ (ìµœê³  ê²°ê³¼)
python train.py --config configs/high_quality.yaml

# UIEB ìµœì í™”
python train.py --config configs/uieb.yaml

# LSUI ìµœì í™”
python train.py --config configs/lsui.yaml
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### Q: ë°ì´í„°ì…‹ì„ ì°¾ì„ ìˆ˜ ì—†ë‹¤ê³  ë‚˜ì™€ìš”
```bash
# ë°ì´í„° êµ¬ì¡° í™•ì¸
python check_dataset.py --dataset_type UIEB --report

# í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
python create_test_data.py --dataset_type UIEB --num_samples 20
```

### Q: GPU ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜
```python
# configì—ì„œ ë°°ì¹˜ í¬ê¸° ì¤„ì´ê¸°
config['data']['batch_size'] = 4  # ê¸°ë³¸ê°’ 8ì—ì„œ 4ë¡œ

# ë˜ëŠ” ê°€ë²¼ìš´ ëª¨ë¸ ì‚¬ìš©
python train.py --config configs/lightweight.yaml
```

### Q: í›ˆë ¨ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë ¤ìš”
```bash
# ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´
python train.py --config configs/lightweight.yaml --exp_name quick_test

# ë˜ëŠ” ì—í¬í¬ ìˆ˜ ì¤„ì´ê¸° (config íŒŒì¼ì—ì„œ num_epochs ë³€ê²½)
```

### Q: ê²°ê³¼ê°€ ë§Œì¡±ìŠ¤ëŸ½ì§€ ì•Šì•„ìš”
```bash
# ë” ë§ì€ ìŠ¤í…ìœ¼ë¡œ ìƒì„±
python test.py --num_steps 100  # ê¸°ë³¸ê°’ 50ì—ì„œ 100ìœ¼ë¡œ

# ê³ í’ˆì§ˆ ëª¨ë¸ ì‚¬ìš©
python train.py --config configs/high_quality.yaml
```

---

## ğŸ“Š ì˜ˆìƒ ì„±ëŠ¥

### í›ˆë ¨ ì‹œê°„ (RTX 3090 ê¸°ì¤€)
- **Lightweight**: ~6ì‹œê°„ (100 ì—í¬í¬)
- **Default**: ~12ì‹œê°„ (500 ì—í¬í¬)  
- **High Quality**: ~24ì‹œê°„ (1000 ì—í¬í¬)

### ì¶”ë¡  ì‹œê°„
- **10 steps**: ~1ì´ˆ/ì´ë¯¸ì§€
- **50 steps**: ~3ì´ˆ/ì´ë¯¸ì§€
- **100 steps**: ~6ì´ˆ/ì´ë¯¸ì§€

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
- **Lightweight**: ~6GB GPU ë©”ëª¨ë¦¬
- **Default**: ~10GB GPU ë©”ëª¨ë¦¬
- **High Quality**: ~16GB GPU ë©”ëª¨ë¦¬

---

## ğŸ¨ ì˜ˆì‹œ ê²°ê³¼

ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì€ ìˆ˜ì¤‘ ì´ë¯¸ì§€ ë¬¸ì œë“¤ì„ í•´ê²°í•©ë‹ˆë‹¤:

1. **ìƒ‰ìƒ ë³µì›**: í‘¸ë¥¸ë¹›/ë…¹ìƒ‰ë¹› ì œê±°, ìì—°ìŠ¤ëŸ¬ìš´ ìƒ‰ìƒ ë³µì›
2. **ëŒ€ë¹„ í–¥ìƒ**: íë¦¿í•œ ì´ë¯¸ì§€ë¥¼ ì„ ëª…í•˜ê²Œ
3. **ì„¸ë¶€ ì‚¬í•­ ë³µì›**: ë¬¼ì˜ ì‚°ë€ìœ¼ë¡œ ì†ì‹¤ëœ ë””í…Œì¼ ë³µêµ¬
4. **ì¡°ëª… ê°œì„ **: ì–´ë‘ìš´ ìˆ˜ì¤‘ í™˜ê²½ì˜ ë°ê¸° ì¡°ì •

---

## ğŸ“ ì§€ì›

- ğŸ› **ë²„ê·¸ ë¦¬í¬íŠ¸**: GitHub Issues
- ğŸ“– **ìì„¸í•œ ë¬¸ì„œ**: README.md, DATA_SETUP.md  
- ğŸ” **ë°ì´í„° ë¬¸ì œ**: `python check_dataset.py --help`
- ğŸ¯ **ëª¨ë¸ ë¬¸ì œ**: `python demo.py --demo model`

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

1. **ë°ëª¨ ì‹¤í–‰**: `python demo.py --demo all`
2. **í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ í›ˆë ¨**: `python train.py --config configs/lightweight.yaml`
3. **ì‹¤ì œ ë°ì´í„° ì¤€ë¹„**: UIEB/LSUI ë‹¤ìš´ë¡œë“œ
4. **ë³¸ê²© í›ˆë ¨**: ê³ í’ˆì§ˆ ëª¨ë¸ë¡œ ì „ì²´ ë°ì´í„°ì…‹ í›ˆë ¨
5. **ê²°ê³¼ ë¶„ì„**: TensorBoardë¡œ í›ˆë ¨ ê³¼ì • ëª¨ë‹ˆí„°ë§

**í–‰ìš´ì„ ë¹•ë‹ˆë‹¤!** ğŸŒŠâœ¨